*** Settings ***
Documentation     NOTE:
...               add note here
Suite Setup       Suite Setup
Force Tags        CHECK_MSI_IS_INSTALLED    win
Test Template     Check Msi Is Installed Template
Resource          ../../resources/keywords.txt

*** Test Cases ***    AUTHOR           SUBJECT     RETURN CODE    RETURN STATUS                   REPORT
Check Installed Package
                      Administrator    Firefox     0              ${ENDED_OK - ended normally}    Package is installed

Check Not Installed Package
                      Administrator    Notexist    0              ${ENDED_OK - ended normally}    "Notexist"

*** Keywords ***
Check Msi Is Installed Template
    [Arguments]    ${author}    ${subject}    ${returnCode}    ${returnStatus}    ${returnReport}
    Init Action    ${ACTION_INSTALL_MSI}
    Action Set    ${PRT_INSTALL_MSI_PACKAGE_NAME}    FirefoxESR-31.3.0-ach.msi
    Action Set    ${PRT_INSTALL_MSI_PACKAGE_PATH}    ${_WORKING_DIR}
    Action Set    ${PRT_INSTALL_MSI_ADMIN_INSTALL}    NO
    Action Set Timeout    600
    Action Execute
    Init Action    ${ACTION_CHECK_MSI_IS_INSTALLED}
    Action Set    ${PRT_CHECK_MSI_IS_INSTALLED_MSI_AUTHOR}    ${author}
    Action Set    ${PRT_CHECK_MSI_IS_INSTALLED_MSI_SUBJECT}    ${subject}
    Action Execute
    Action Report Should Be Found
    Action Return Code Should Be    ${returnCode}
    Action Return Status Should Be    ${returnStatus}
    Action Report Should Contain    ${returnReport}
